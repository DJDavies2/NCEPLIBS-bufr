<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NCEPLIBS-bufr: ufbseq.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">NCEPLIBS-bufr<span id="projectnumber">&#160;11.7.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('ufbseq_8f.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle"><div class="title">ufbseq.f File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Read/write an entire sequence of data values from/to a data subset.  
<a href="#details">More...</a></p>

<p><a href="ufbseq_8f_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:aa96ada82e0e2f98226594f3532bb245d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ufbseq_8f.html#aa96ada82e0e2f98226594f3532bb245d">ufbseq</a> (LUNIN, USR, I1, I2, IRET, STR)</td></tr>
<tr class="memdesc:aa96ada82e0e2f98226594f3532bb245d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine reads or writes an entire sequence of data values from or to the BUFR data subset that is currently open within the BUFRLIB internal arrays.  <a href="ufbseq_8f.html#aa96ada82e0e2f98226594f3532bb245d">More...</a><br /></td></tr>
<tr class="separator:aa96ada82e0e2f98226594f3532bb245d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Read/write an entire sequence of data values from/to a data subset. </p>

<p class="definition">Definition in file <a class="el" href="ufbseq_8f_source.html">ufbseq.f</a>.</p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="aa96ada82e0e2f98226594f3532bb245d" name="aa96ada82e0e2f98226594f3532bb245d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa96ada82e0e2f98226594f3532bb245d">&#9670;&nbsp;</a></span>ufbseq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine ufbseq </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>LUNIN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(i1,i2)&#160;</td>
          <td class="paramname"><em>USR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>I1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>I2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>IRET</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*(*)&#160;</td>
          <td class="paramname"><em>STR</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine reads or writes an entire sequence of data values from or to the BUFR data subset that is currently open within the BUFRLIB internal arrays. </p>
<p >The direction of the data transfer is determined by the context of ABS(LUNIN):</p><ul>
<li>If ABS(LUNIN) points to a file that was previously opened for input using subroutine <a class="el" href="openbf_8f.html#a9bea9aeada166bd9037b959ca8452b28" title="This subroutine connects a new file to the BUFRLIB software for input or output operations.">openbf()</a>, then data values are read from the current data subset.</li>
<li>If ABS(LUNIN) points to a file that was previously opened for output using subroutine <a class="el" href="openbf_8f.html#a9bea9aeada166bd9037b959ca8452b28" title="This subroutine connects a new file to the BUFRLIB software for input or output operations.">openbf()</a>, then data values are written to the current data subset.</li>
</ul>
<p >This subroutine is specifically designed for use with a single Table A or Table D mnemonic. In the latter case, the mnemonic may be replicated within the overall subset definition, and in which case the subroutine will return all data values within all replications of the sequence defined by the mnemonic. But in either case, the mnemonic itself may contain, within its own sequence definition, any number of data values defined by Table B mnemonics and/or subsequences of data values defined by other Table D mnemonics, and any such subsequences may themselves be replicated using any manner of fixed or delayed replication. See <a class="el" href="md__home_jeffa_nceplibs_bufr_docs_dfbftab.html#ufbsubs">DX BUFR Tables</a> for more details including an example use case, and see also subroutines <a class="el" href="ufbint_8f.html#afe3364a491b49e0c9e5a526b009aaa75" title="This subroutine reads or writes one or more data values from or to the BUFR data subset that is curre...">ufbint()</a>, <a class="el" href="ufbrep_8f.html#adb981832bdbbb26903265fb946aac58c" title="This subroutine reads or writes one or more data values from or to the BUFR data subset that is curre...">ufbrep()</a> and <a class="el" href="ufbstp_8f.html#a8153bb675bd7b02b4a2a58b77ba9d581" title="This subroutine reads or writes one or more data values from or to the BUFR data subset that is curre...">ufbstp()</a> which are also used to read/write one or more data values from/to a data subset but cannot themselves be directly used with Table A or Table D mnemonics.</p>
<dl class="section author"><dt>Authors</dt><dd>J. Woollen </dd>
<dd>
J. Ator </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2000-09-19</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">LUNIN</td><td>&ndash; integer: Absolute value is Fortran logical unit number for BUFR file </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">USR</td><td>&ndash; real*8(*,*): Data values<ul>
<li>If ABS(LUNIN) was opened for input, then USR is output from this subroutine and contains data values that were read from the current data subset.</li>
<li>If ABS(LUNIN) was opened for output, then USR is input to this subroutine and contains data values that are to be written to the current data subset. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">I1</td><td>&ndash; integer: Actual first dimension of USR as allocated within the calling program </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">I2</td><td>&ndash; integer:<ul>
<li>If ABS(LUNIN) was opened for input, then I2 must be set equal to the actual second dimension of USR as allocated within the calling program</li>
<li>If ABS(LUNIN) was opened for output, then I2 must be set equal to the number of replications of STR that are to be written to the data subset </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">IRET</td><td>&ndash; integer: Number of replications of STR that were actually read/written from/to the data subset </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">STR</td><td>&ndash; character*(*): String consisting of a single Table A or Table D mnemonic whose sequence definition is in one-to-one correspondence with the number of data values that will be read/written from/to the data subset within the first dimension of USR (see <a class="el" href="md__home_jeffa_nceplibs_bufr_docs_dfbftab.html#dfbftab">DX BUFR Tables</a> for further information about Table A and Table D mnemonics)</td></tr>
  </table>
  </dd>
</dl>
<p >It is the user's responsibility to ensure that USR is dimensioned sufficiently large enough to accommodate the number of data values that are to be read from or written to the data subset. Note also that USR is an array of real*8 values; therefore, any data that are to be written out as character (i.e. CCITT IA5) values in BUFR must be converted from character into real*8 format within the application program before calling this subroutine. Conversely, when this subroutine is being used to read character values from a data subset, the value that is returned will be in real*8 format and must be converted back into character format by the application program before it can be used as such. Alternatively, there are different subroutines such as <a class="el" href="readlc_8f.html#acf408b0943fc7a5040009cd9a9bc57a1" title="This subroutine reads a long character string (greater than 8 bytes) from a data subset.">readlc()</a> and <a class="el" href="writlc_8f.html#a7017d5359bb32ce5407499d7a1b16709" title="This subroutine writes a long character string (greater than 8 bytes) to a data subset.">writlc()</a> which can be used to read/write character data directly from/to a data subset without the need to convert from/to real*8 format as an intermediate step.</p>
<p >Numeric (i.e. non-character) data values within USR are always in the exact units specified for the corresponding mnemonic within the relevant DX or master BUFR table, without any scale or reference values applied. Specifically, this means that, when writing data values into an output subset, the user only needs to store each respective value into USR using the units specified within the table, and the BUFRLIB software will take care of any necessary scaling or referencing of the value before it is actually encoded into BUFR. Conversely, when reading data values from an input subset, the values returned in USR are already de-scaled and de-referenced and, thus, are already in the exact units that were defined for the corresponding mnemonics within the table.</p>
<p >"Missing" values in USR are always denoted by a unique placeholder value. This placeholder value is initially set to a default value of 10E10_8, but it can be reset to any substitute value of the user's choice via a separate call to subroutine <a class="el" href="setbmiss_8f.html#a5435d5821267af076f83cefdf3c1c7f8" title="This subroutine allows the user to specify a customized value to represent &quot;missing&quot; data when readin...">setbmiss()</a>. In any case, and whenever this subroutine is used to read data values from an input subset, any returned value in USR can be easily checked for equivalence to the current placeholder value via a call to function <a class="el" href="ibfms_8f.html#a0f7ba3ed6f17e76d912b4f13ea70967e" title="This function provides a handy way to check whether a real*8 data value returned from a previous call...">ibfms()</a>, and a positive result means that the value for the corresponding mnemonic was encoded as "missing" in BUFR (i.e. all bits set to 1) within the original data subset. Conversely, whenever this subroutine is used to write data values to an output subset, the current placeholder value can be obtained via a separate call to function <a class="el" href="getbmiss_8f.html#a2e6035695a459284e0592a2452b2f168" title="This function returns the current placeholder value which represents &quot;missing&quot; data when reading from...">getbmiss()</a>, and the resulting value can then be stored into the USR array whereever the user desires a BUFR "missing" value (i.e. all bits set to 1) to be encoded for the corresponding mnemonic within the output subset.</p>
<dl class="section remark"><dt>Remarks</dt><dd><ul>
<li>If LUNIN &lt; 0, and if ABS(LUNIN) points to a file that is open for output (writing BUFR), then the subroutine will treat the file pointed to by ABS(LUNIN) as though it was open for input (reading BUFR). This is a special capability for use by some applications that need to read certain values back out from a BUFR file during the same time that it is in the process of being written to.</li>
<li>If ABS(LUNIN) points to a file that is open for output (writing BUFR), and if the data values to be written are part of a sequence replicated using delayed replication, then a call to subroutine <a class="el" href="drfini_8f.html#ab9d63d7c2b99152be8e0809413adf621" title="This subroutine explicitly initializes delayed replication factors and allocates a corresponding amou...">drfini()</a> must be made prior to calling this subroutine, in order to pre-allocate the necessary internal array space for the number of replications of the sequence.</li>
</ul>
</dd></dl>
<p><b>Program history log:</b> </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date   </th><th class="markdownTableHeadNone">Programmer   </th><th class="markdownTableHeadNone">Comments    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2000-09-19   </td><td class="markdownTableBodyNone">J. Woollen   </td><td class="markdownTableBodyNone">Original author    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2002-05-14   </td><td class="markdownTableBodyNone">J. Woollen   </td><td class="markdownTableBodyNone">Improved generality; previously ufbseq would not recognize compressed delayed replication as a legitimate data structure    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2003-05-19   </td><td class="markdownTableBodyNone">J. Woollen   </td><td class="markdownTableBodyNone">Corrected the logic array of exit conditions for the subroutine; previously, in some cases, proper exits were missed, generating bogus error messages    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2003-11-04   </td><td class="markdownTableBodyNone">S. Bender   </td><td class="markdownTableBodyNone">Added remarks and routine interdependencies    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2003-11-04   </td><td class="markdownTableBodyNone">D. Keyser   </td><td class="markdownTableBodyNone">Unified/portable for WRF; added documentation; outputs more complete diagnostic info when routine terminates abnormally    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2004-08-18   </td><td class="markdownTableBodyNone">J. Ator   </td><td class="markdownTableBodyNone">Added SAVE for IFIRST1 and IFIRST2 flags    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2007-01-19   </td><td class="markdownTableBodyNone">J. Ator   </td><td class="markdownTableBodyNone">Replaced call to parseq with call to <a class="el" href="parstr_8f.html#a3379a342ab3d92dd01eef1f3172f9b86" title="THIS SUBROUTINE PARSES A STRING CONTAINING ONE OR MORE SUBSTRINGS INTO AN ARRAY OF SUBSTRINGS.">parstr()</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2009-04-21   </td><td class="markdownTableBodyNone">J. Ator   </td><td class="markdownTableBodyNone">Use <a class="el" href="errwrt_8f.html#a65626d9a772648676146b62b596c2764" title="This subroutine allows the user to specify a custom location for the logging of error and diagnostic ...">errwrt()</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2014-09-10   </td><td class="markdownTableBodyNone">J. Ator   </td><td class="markdownTableBodyNone">Fix bug involving nested delayed replication where first replication of outer sequence does not contain a replication of the inner sequence    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2014-12-10   </td><td class="markdownTableBodyNone">J. Ator   </td><td class="markdownTableBodyNone">Use modules instead of COMMON blocks    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2020-03-06   </td><td class="markdownTableBodyNone">J. Ator   </td><td class="markdownTableBodyNone">No longer abort when reading data and number of available levels is greater than I2; instead just return first I2 levels and print a diagnostic message   </td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="ufbseq_8f_source.html#l00142">142</a> of file <a class="el" href="ufbseq_8f_source.html">ufbseq.f</a>.</p>

<p class="reference">References <a class="el" href="namespacemodv__bmiss.html#a4e62f0091102c93beac0252bdd591641">modv_bmiss::bmiss</a>, <a class="el" href="bort_8f.html#a488d3a8cf930fb592a9fdaefcfa04ac4">bort()</a>, <a class="el" href="errwrt_8f.html#a65626d9a772648676146b62b596c2764">errwrt()</a>, <a class="el" href="invtag_8f.html#a307883c6492d9e7dab968c16ac0fb673">invtag()</a>, <a class="el" href="invwin_8f.html#ac26ae485efa93dee816efb648bdfcc8b">invwin()</a>, <a class="el" href="namespacemoda__tables.html#a1c178b3f0fb4f7ad1380cb7509d371a7">moda_tables::isc</a>, <a class="el" href="namespacemoda__tables.html#a0d02cd4fff2bdd0fbf7ec08a5cb6ce32">moda_tables::itp</a>, <a class="el" href="namespacemoda__tables.html#af0011251f23eeb68a68082203e016d96">moda_tables::jmpb</a>, <a class="el" href="namespacemoda__tables.html#a055602ab4ef62ed7220ea308013d89b9">moda_tables::link</a>, <a class="el" href="parstr_8f.html#a3379a342ab3d92dd01eef1f3172f9b86">parstr()</a>, <a class="el" href="status_8f.html#a22292e7a69c411a961168198d259f336">status()</a>, <a class="el" href="namespacemoda__tables.html#a72f922bfc79b111f1bf8487defd6ea2b">moda_tables::tag</a>, and <a class="el" href="namespacemoda__tables.html#a1d6fb8d806a42e177ff8a3f5aa31a5d9">moda_tables::typ</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_30c37837910170b6dae887e9df3b66a9.html">nceplibs-bufr</a></li><li class="navelem"><a class="el" href="dir_e81fc8df062d10d5f2b231f7e4ab81b8.html">src</a></li><li class="navelem"><a class="el" href="ufbseq_8f.html">ufbseq.f</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
