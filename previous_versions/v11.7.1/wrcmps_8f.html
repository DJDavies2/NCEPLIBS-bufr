<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NCEPLIBS-bufr: wrcmps.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">NCEPLIBS-bufr<span id="projectnumber">&#160;11.7.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('wrcmps_8f.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle"><div class="title">wrcmps.f File Reference</div></div>
</div><!--header-->
<div class="contents">

<p><a href="wrcmps_8f_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a8b333832f77606059ec94ba8b80d4e8d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wrcmps_8f.html#a8b333832f77606059ec94ba8b80d4e8d">wrcmps</a> (LUNIX)</td></tr>
<tr class="memdesc:a8b333832f77606059ec94ba8b80d4e8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">THIS SUBROUTINE PACKS UP THE CURRENT SUBSET WITHIN MEMORY (ARRAY IBAY IN MODULE BITBUF), STORING IT FOR COMPRESSION.  <a href="wrcmps_8f.html#a8b333832f77606059ec94ba8b80d4e8d">More...</a><br /></td></tr>
<tr class="separator:a8b333832f77606059ec94ba8b80d4e8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>WOOLLEN </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2002-05-14 </dd></dl>

<p class="definition">Definition in file <a class="el" href="wrcmps_8f_source.html">wrcmps.f</a>.</p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a8b333832f77606059ec94ba8b80d4e8d" name="a8b333832f77606059ec94ba8b80d4e8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b333832f77606059ec94ba8b80d4e8d">&#9670;&nbsp;</a></span>wrcmps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine wrcmps </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>LUNIX</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>THIS SUBROUTINE PACKS UP THE CURRENT SUBSET WITHIN MEMORY (ARRAY IBAY IN MODULE BITBUF), STORING IT FOR COMPRESSION. </p>
<p >IT THEN TRIES TO ADD IT TO THE COMPRESSED BUFR MESSAGE THAT IS CURRENTLY OPEN WITHIN MEMORY FOR ABS(LUNIX) (ARRAY MGWA). IF THE SUBSET WILL NOT FIT INTO THE CURRENTLY OPEN MESSAGE, THEN THAT COMPRESSED MESSAGE IS FLUSHED TO LUNIX AND A NEW ONE IS CREATED IN ORDER TO HOLD THE CURRENT SUBSET (STILL STORED FOR COMPRESSION). THIS SUBROUTINE PERFORMS FUNCTIONS SIMILAR TO BUFR ARCHIVE LIBRARY SUBROUTINE MSGUPD EXCEPT THAT IT ACTS ON COMPRESSED BUFR MESSAGES.</p>
<p >PROGRAM HISTORY LOG: 2002-05-14 J. WOOLLEN &ndash; ORIGINAL AUTHOR 2003-11-04 S. BENDER &ndash; ADDED REMARKS/BUFRLIB ROUTINE INTERDEPENDENCIES 2003-11-04 D. KEYSER &ndash; MAXJL (MAXIMUM NUMBER OF JUMP/LINK ENTRIES) INCREASED FROM 15000 TO 16000 (WAS IN VERIFICATION VERSION); LOGICAL VARIABLES "WRIT1" AND "FLUSH" NOW SAVED IN GLOBAL MEMORY (IN COMMON BLOCK /COMPRS/), THIS FIXED A BUG IN THIS ROUTINE WHICH CAN LEAD TO MESSAGES BEING WRITTEN OUT BEFORE THEY ARE FULL; UNIFIED/PORTABLE FOR WRF; ADDED DOCUMENTATION (INCLUDING HISTORY); OUTPUTS MORE COMPLETE DIAGNOSTIC INFO WHEN ROUTINE TERMINATES ABNORMALLY 2004-08-18 J. ATOR &ndash; REMOVE CALL TO XMSGINI (CMSGINI NOW HAS SAME CAPABILITY); IMPROVE DOCUMENTATION; CORRECT LOGIC FOR WHEN A CHARACTER VALUE IS THE SAME FOR ALL SUBSETS IN A MESSAGE; MAXIMUM MESSAGE LENGTH INCREASED FROM 20,000 TO 50,000 BYTES 2004-08-18 J. WOOLLEN &ndash; 1) ADDED SAVE FOR LOGICAL 'FIRST' 2) ADDED 'KMISS' TO FIX BUG WHICH WOULD OCCASIONALLY SKIP OVER SUBSETS 3) ADDED LOGIC TO MAKE SURE MISSING VALUES ARE REPRESENTED BY INCREMENTS WITH ALL BITS ON 4) REMOVED TWO UNECESSARY REFERENCES TO 'WRIT1' 2005-11-29 J. ATOR &ndash; FIX INITIALIZATION BUG FOR CHARACTER COMPRESSION; INCREASE MXCSB TO 4000; USE IUPBS01; CHECK EDITION NUMBER OF BUFR MESSAGE BEFORE PADDING TO AN EVEN BYTE COUNT 2009-03-23 J. ATOR &ndash; ADDED SAVE FOR IBYT AND JBIT; USE MSGFULL 2009-08-11 J. WOOLLEN &ndash; MADE CATX AND CSTR BIGGER TO HANDLE LONGER STRINGS. ALSO SEPARATED MATX,CATX,NCOL FROM OTHER VARS IN COMMON COMPRS FOR USE IN SUBROUTINE WRITLC. ALSO PASSED MBAY(1,LUN) AS ARRAY TO INITIAL CALL TO CMSGINI IN ORDER FOR USE BY WRITLC. 2012-02-17 J. ATOR &ndash; FIXED A BUG INVOLVING COMPRESSED FILES WITH EMBEDDED DICTIONARY MESSAGES 2014-12-03 J. ATOR &ndash; USE PKX TO PACK LOCAL REFERENCE VALUE FOR CHARACTER STRINGS 2014-12-10 J. ATOR &ndash; USE MODULES INSTEAD OF COMMON BLOCKS 2015-09-24 D. STOKES &ndash; INCLUDE EDGE4 IN SAVE LIST 2016-03-18 J. ATOR &ndash; FIX BUG INVOLVING ENCODING OF LONG CHARACTER STRINGS (VIA WRITLC) INTO MESSAGES WHICH ALSO CONTAIN DELAYED REPLICATION SEQUENCES 2021-02-24 J. ATOR &ndash; USE IPKM AND PKC INSTEAD OF PKX 2022-05-06 J. WOOLLEN &ndash; USE PKB8 FOR PACKING 8BYTE INTEGERS</p>
<p >USAGE: CALL WRCMPS (LUNIX) INPUT ARGUMENT LIST: LUNIX - INTEGER: ABSOLUTE VALUE IS FORTRAN LOGICAL UNIT NUMBER FOR BUFR FILE (IF LUNIX IS LESS THAN ZERO, THIS IS A "FLUSH" CALL AND THE BUFFER MUST BE CLEARED OUT)</p>
<p >REMARKS: THIS ROUTINE CALLS: BORT CMSGINI IUPBS01 MSGFULL MSGWRT PKB PKC PKX STATUS UPB UPC USRTPL THIS ROUTINE IS CALLED BY: CLOSMG WRITSA WRITSB PKB8 Normally not called by any application programs. </p>

<p class="definition">Definition at line <a class="el" href="wrcmps_8f_source.html#l00080">80</a> of file <a class="el" href="wrcmps_8f_source.html">wrcmps.f</a>.</p>

<p class="reference">References <a class="el" href="bort_8f.html#a488d3a8cf930fb592a9fdaefcfa04ac4">bort()</a>, <a class="el" href="cmsgini_8f.html#ace74c243976a7546e92121317b36f9de">cmsgini()</a>, <a class="el" href="namespacemoda__tables.html#a729c4578db36e716bb8bb25ef52492f7">moda_tables::ibt</a>, <a class="el" href="ipkm_8f.html#a8826417bb81a4404779e606d6b97759a">ipkm()</a>, <a class="el" href="namespacemoda__tables.html#a0d02cd4fff2bdd0fbf7ec08a5cb6ce32">moda_tables::itp</a>, <a class="el" href="iupbs01_8f.html#adcd6f7c2f898b4f938153c5cf79a9cf5">iupbs01()</a>, <a class="el" href="namespacemoda__bitbuf.html#a983cdfefb8e99f7ede13ce9f979bea3e">moda_bitbuf::mbay</a>, <a class="el" href="msgwrt_8f.html#ac95ecf1436ba14805a33efd29fab1e5d">msgwrt()</a>, <a class="el" href="namespacemodv__mxcdv.html#a18965e331fd9a13ea630da6e16f9b50c">modv_mxcdv::mxcdv</a>, <a class="el" href="namespacemodv__mxcsb.html#af3878c2202c2f623c542550f54558644">modv_mxcsb::mxcsb</a>, <a class="el" href="pkb_8f.html#a35aa2e691ff3ad32de9d8721cae613f7">pkb()</a>, <a class="el" href="pkb8_8f.html#ad41a6d2e1a35c122af15bbc6dffe8eaa">pkb8()</a>, <a class="el" href="pkc_8f.html#a0376a4af04f7be036484c666ebbb8ef9">pkc()</a>, <a class="el" href="status_8f.html#a22292e7a69c411a961168198d259f336">status()</a>, <a class="el" href="namespacemoda__tables.html#a72f922bfc79b111f1bf8487defd6ea2b">moda_tables::tag</a>, <a class="el" href="up8_8f.html#a9934a3d9c66ea78c7c132066798583f9">up8()</a>, <a class="el" href="upc_8f.html#ae2afdf50d0bf4063426faeae29515208">upc()</a>, and <a class="el" href="usrtpl_8f.html#a677bf700a4a6f0626a41921cd66d8ed9">usrtpl()</a>.</p>

<p class="reference">Referenced by <a class="el" href="closmg_8f.html#a3378111de0136710daec2ded25ed34e4">closmg()</a>, <a class="el" href="writsa_8f.html#a50e3c630fd99f545e2427fe9b18c4d48">writsa()</a>, and <a class="el" href="writsb_8f.html#a02b3dbd97116388430f863f3e49fa47f">writsb()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_30c37837910170b6dae887e9df3b66a9.html">nceplibs-bufr</a></li><li class="navelem"><a class="el" href="dir_e81fc8df062d10d5f2b231f7e4ab81b8.html">src</a></li><li class="navelem"><a class="el" href="wrcmps_8f.html">wrcmps.f</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
